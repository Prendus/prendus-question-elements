<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../redux-store-element/redux-store.html">
<link rel="import" href="prendus-view-question/prendus-view-question.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/wysiwyg-e/wysiwyg-e.html">
<link rel="import" href="../../bower_components/juicy-ace-editor/juicy-ace-editor.html">

<dom-module id="prendus-edit-question">
    <template>
        <style>
            .pages {
                margin-top: 10px;
            }

            .editor {
                width: calc(1000px - 10vw);
                height: 50vh;
                box-shadow: 0px 0px 3px grey;
                margin: 0 auto;
            }

            .editorContainer {
                position: relative;
            }

            #paperTabs {
                font-size: calc(50px - 1vw);
                --paper-tabs-selection-bar-color: #2a9af2;
                --paper-tab-ink: grey;
                --paper-tab-content: {
                    font-family: Ubuntu;
                }
            }

            #textEditor {
                --wysiwyg-font: Ubuntu;
                font-size: calc(40px - 1vw);
            }

            #codeEditor {
                font-size: calc(40px - 1vw);
            }

            .previewContainer {
                box-shadow: 0px 0px 3px grey;
                padding: 25px;
                margin-top: 25px;
            }

            .savingText {
                color: grey;
                position: absolute;
                right: 20px;
                bottom: 15px;
            }
        </style>

        <redux-store id="reduxStoreElement" action="[[action]]" on-statechange="stateChange"></redux-store>

        <dom-if if="[[loaded]]">
            <template>
                <paper-tabs id="paperTabs" selected="[[selected]]" on-selected-changed="selectedChanged">
                    <paper-tab>Question</paper-tab>
                    <paper-tab>Answer</paper-tab>
                </paper-tabs>

                <iron-pages id="ironPages" selected="[[selected]]" class="pages">
                    <div class="editorContainer">
                        <wysiwyg-e id="textEditor" class="editor" value="[[question.text]]" on-value-changed="textEditorChanged"></wysiwyg-e>
                        <div class="savingText">[[getSavingText(saving)]]</div>
                    </div>

                    <div class="editorContainer">
                        <juicy-ace-editor id="codeEditor" theme="ace/theme/chrome" mode="ace/mode/javascript" class="editor" value="[[question.code]]" on-change="codeEditorChanged"></juicy-ace-editor>
                        <div class="savingText">[[getSavingText(saving)]]</div>
                    </div>
                </iron-pages>

                <div class="previewContainer">
                    <prendus-view-question question="[[question]]"></prendus-view-question>
                </div>
            </template>
        </dom-if>

        <dom-if if="[[!loaded]]">
            <template>
                Loading...
            </template>
        </dom-if>
    </template>

    <script src="prendus-edit-question.ts"></script>
</dom-module>
